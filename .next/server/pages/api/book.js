"use strict";(()=>{var e={};e.id=104,e.ids=[104],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5611:e=>{e.exports=import("nanoid")},8235:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>c});var n=r(1802),a=r(7153),i=r(6249),s=r(995),d=e([s]);s=(d.then?(await d)():d)[0];let u=(0,i.l)(s,"default"),l=(0,i.l)(s,"config"),c=new n.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/book",pathname:"/api/book",bundlePath:"",filename:""},userland:s});o()}catch(e){o(e)}})},995:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{default:()=>handler});var n=r(5611),a=e([n]);n=(a.then?(await a)():a)[0];let{getStore:i}=r(6012),{chooseRooms:s}=r(9665);function handler(e,t){if("POST"!==e.method)return t.status(405).end();let{numRooms:r}=e.body,o=parseInt(r,10);if(!Number.isInteger(o)||o<1||o>5)return t.status(400).json({error:"numRooms must be integer 1..5"});let a=i();if(!a.rooms)return t.status(500).json({error:"store not initialized"});let d=a.rooms.filter(e=>!e.occupied);if(d.length<o)return t.status(400).json({error:"Not enough available rooms"});let u=s(d,o);if(!u||u.length!==o)return t.status(500).json({error:"Could not find rooms"});let l=(0,n.nanoid)();u.forEach(e=>{let t=a.rooms.find(t=>t.id===e.id);t.occupied=!0,t.bookingId=l});let c={id:l,rooms:u.map(e=>e.id),createdAt:new Date().toISOString()};return a.bookings=a.bookings||[],a.bookings.push(c),t.status(200).json({booking:c})}o()}catch(e){o(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,18],()=>__webpack_exec__(8235));module.exports=r})();